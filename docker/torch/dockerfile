FROM haydnj/ml_base:latest

RUN uv pip install torch torchvision torchaudio --find-links https://download.pytorch.org/whl/cu124

RUN uv pip install \
    botorch \
    datasets \
    einops \
    fcd \
    fire \
    git+https://github.com/haydn-jones/guacamol \
    gpytorch \
    hf_transfer \
    hnn-utils \
    ipython \
    joblib \
    lightning \
    matplotlib \
    more_itertools \
    pandas \
    polars \
    pyarrow \
    rich \
    schedulefree \
    selfies \
    tqdm \
    wandb 

RUN uv pip install flash-attn --no-build-isolation